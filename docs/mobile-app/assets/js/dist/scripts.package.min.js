var TVMaze_API=function(){this.cache={},this.lastRequest=!1,this.lastResponse=!1};TVMaze_API.prototype.setCache=function(e,t){t=JSON.stringify(t),this.cache[e]=t,localStorage.setItem(e,t)},TVMaze_API.prototype.getCache=function(e){var t=(new Date).getTime();if(this.cache.hasOwnProperty(e)&&this.cache[e].setAt<t-300)return this.cache;if(localStorage.getItem(e)){var s=JSON.parse(localStorage.getItem(e));if(s.setAt<t-300)return s}return!1},TVMaze_API.prototype.removeExpiredCache=function(){},TVMaze_API.prototype.get=function(e,t){var s=this._request(),n=this,o=!1;if(!1!==s){if(this.lastRequest=e,cache.hasOwnProperty(e)&&cache[e].setAt<timestamp-300)return cache[e].response;s.request.open("GET","https://api.tvmaze.com/"+e,!0),s.request.send(),s.request.addEventListener("load",function(){o=JSON.parse(s.request.responseText),n.cache[e]={},n.cache[e].response=o,n.cache[e].setAt=o,this.lastResponse=o,t(o)},!1),s.request.addEventListener("error",function(){o=JSON.parse(s.request.responseText),this.lastResponse=o,t(o)},!1)}return t(!1),!1},TVMaze_API.prototype._request=function(){return!!window.XMLHttpRequest&&new XMLHttpRequest};var TVMaze_Controller=function(e){this.view=e.view,this.api=e.api,window.onload=function(){document.getElementById("button-search")&&document.getElementById("button-search").onclick(function(){document.getElementById("input-search").value})}},TVMaze_View=function(e){};TVMaze_View.prototype._template=function(e,t){var s=this.templates.hasOwnProperty(e)?this.templates[e]:document.getElementById(e).innerHTML;if(s)for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&(s=this._replaceAll(s,"{"+n+"}",t[n]));return this._replaceAll(s,"{.*}","",!1)},TVMaze_View.prototype._escapeRegExp=function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},TVMaze_View.prototype._replaceAll=function(e,t,s,n){return null===s&&(s=""),void 0!==n&&!1!==n&&(t=this._escapeRegExp(t)),void 0!==e&&""!==e&&e.replace(new RegExp(t,"g"),s)};var TVMaze_Interface_Model_API=function(){this.baseQuery=null};TVMaze_Interface_Model_API.prototype.get=function(e,t){return e=this.baseQuery+e,(new TVMaze_API).get(e,t)};var TVMaze_Model_Episode=function(){TVMaze_Interface_Model_API.call(this),this.baseQuery="episodes/"},TVMaze_Model_Season=function(e){TVMaze_Interface_Model_API.call(this),this.baseQuery="seasons/",this.id=e,this.episodes=[]};TVMaze_Model_Season.prototype.getId=function(){return this.id},TVMaze_Model_Season.prototype.setId=function(e){return this.id=e,this},TVMaze_Model_Season.prototype.getEpisodes=function(){if(this.id=id,this.episodes)return this.episodes;var e=this.get(this.baseQuery+this.id+"/episodes");if(e&&0<e.length)for(var t=0;t<e.length;t++)this.episodes.push(new TVMaze_Model_Episode(e[t]));return this.episodes};var TVMaze_Model_Show=function(){TVMaze_Interface_Model_API.call(this),this.baseQuery="shows/",this.seasons=[]},containerID="tv-maze-container",TV_Maze=new TVMaze_Controller({containerID:containerID});